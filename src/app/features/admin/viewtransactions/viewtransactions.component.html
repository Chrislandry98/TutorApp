<div class="container py-4">

    
    <div class="mb-4">
        <a routerLink="/admin/dashboard" class="btn btn-sm btn btn-primary btn-lg back-to-dashboard-btn">
            <i class="bi bi-arrow-left me-1"></i> Back to Dashboard
        </a>
    </div>
    
    <h1 class="h3 fw-bold mb-4">Transaction Oversight</h1>

    <div class="row mb-5">
        <div class="col-sm-6 col-lg-3 mb-3">
            <div class="card shadow-sm p-3">
                <p class="text-muted small mb-1">Total Revenue</p>
                <h2 class="h4 fw-bold mb-0 text-success">{{ formatCurrency(summary.totalRevenue) }}</h2>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3 mb-3">
            <div class="card shadow-sm p-3">
                <p class="text-muted small mb-1">Total Recharges</p>
                <h2 class="h4 fw-bold mb-0">{{ formatCurrency(summary.totalRecharges) }}</h2>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3 mb-3">
            <div class="card shadow-sm p-3">
                <p class="text-muted small mb-1">Total Bookings</p>
                <h2 class="h4 fw-bold mb-0">{{ summary.totalBookings }}</h2>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3 mb-3">
            <div class="card shadow-sm p-3">
                <p class="text-muted small mb-1">Pending Transactions</p>
                <h2 class="h4 fw-bold mb-0 text-warning text-dark">{{ summary.pendingTransactions }}</h2>
            </div>
        </div>
    </div>

    <div class="card shadow-sm p-4 mb-5">
        <div class="row g-3 align-items-end">
            
            <div class="col-lg-3 col-md-6">
                <label for="searchUser" class="form-label visually-hidden">User ID or Name</label>
                <input type="text" 
                       id="searchUser" 
                       class="form-control" 
                       placeholder="Search by User ID or Name"
                       [(ngModel)]="filters.userSearch">
            </div>
            <div class="col-lg-3 col-md-6">
                <label for="startDate" class="form-label visually-hidden">Start Date</label>
                <input type="date" 
                       id="startDate" 
                       class="form-control" 
                       placeholder="Start Date"
                       [(ngModel)]="filters.startDate">
            </div>
            <div class="col-lg-3 col-md-6">
                <label for="endDate" class="form-label visually-hidden">End Date</label>
                <input type="date" 
                       id="endDate" 
                       class="form-control" 
                       placeholder="End Date"
                       [(ngModel)]="filters.endDate">
            </div>
            <div class="col-lg-3 col-md-6">
                <label for="transactionType" class="form-label visually-hidden">Transaction Type</label>
                <select id="transactionType" class="form-select" [(ngModel)]="filters.transactionType">
                    <option value="">Transaction Type</option>
                    <option value="Booking">Payment</option>
                    <option value="Recharge">Recharge</option>
                </select>
            </div>
            
            <div class="col-lg-3 col-md-6">
                <label for="status" class="form-label visually-hidden">Status</label>
                <select id="status" class="form-select" [(ngModel)]="filters.status">
                    <option value="">Status</option>
                    <option value="Completed">Completed</option>
                    <option value="Pending">Pending</option>
                    <option value="Failed">Failed</option>
                </select>
            </div>
            <div class="col-lg-3 col-md-3">
                <button class="btn btn-primary w-100" (click)="applyFilters()">Apply Filters</button>
            </div>
            <div class="col-lg-3 col-md-3">
                <button class="btn btn-outline-secondary w-100" (click)="resetFilters()">Reset</button>
            </div>

        </div>
    </div>

    <div class="card shadow-sm p-4">
        <h2 class="h5 fw-bold mb-3">Transaction History</h2>

        <div class="table-responsive">
            <table class="table table-hover align-middle">
                <thead>
                    <tr class="text-muted small text-uppercase">
                        <th scope="col">Transaction ID</th>
                        <th scope="col">User</th>
                        <th scope="col">Type</th>
                        <th scope="col">Amount</th>
                        <th scope="col">Date</th>
                        <th scope="col">Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let transaction of filteredTransactions; let i = index">
                        <td class="fw-bold">{{ transaction.id }}</td>
                        <td>{{ transaction.user }}</td>
                        <td>{{ transaction.type }}</td>
                        <td>
                            <span [class.text-success]="transaction.type === 'Recharge'"
                                  [class.text-danger]="transaction.type === 'Payment'">
                                {{ formatCurrency(transaction.amount) }}
                            </span>
                        </td>
                        <td>{{ transaction.date }}</td>
                        <td>
                            <span class="badge" [ngClass]="getStatusClass(transaction.status)">
                                {{ transaction.status }}
                            </span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="d-flex justify-content-between align-items-center mt-3 small">
            <span>Showing 1-{{ transactionsPerPage }} of {{ allTransactions.length }} transactions</span>
            <div>
                <button class="btn btn-sm btn-outline-secondary me-2" (click)="goToPreviousPage()" [disabled]="currentPage === 1">Previous</button>
                <button class="btn btn-sm btn-outline-secondary" (click)="goToNextPage()" [disabled]="currentPage === totalPages">Next</button>
            </div>
        </div>
    </div>
</div>
